# üìã –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ Railway

## ‚úÖ –ß—Ç–æ –º—ã –ø—Ä–æ–≤–µ—Ä–∏–ª–∏

–ó–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –±—ç–∫–µ–Ω–¥ Railway:
- **URL**: `https://pfpbackend-production.up.railway.app`
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç**: `/api/client/calculate`
- **Request ID**: `flYdRym4QJWu3bZA0-QtfA` (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)

## üîç –ì–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –Ω–∞ Railway

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Railway Dashboard](https://railway.app)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Deployments**
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
5. –ù–∞–∂–º–∏—Ç–µ **View Logs** –∏–ª–∏ **Logs**

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Railway CLI:
```bash
railway logs
```

## üìù –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –ª–æ–≥–∞—Ö

### –î–ª—è —Ü–µ–ª–∏ "–î–æ–º" (goal_type_id: 4)

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –†–∞—Å—á–µ—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –Ω–∞—à–µ–º –±—ç–∫–µ–Ω–¥–µ.

–í –ª–æ–≥–∞—Ö –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- ‚ùå –õ–æ–≥–æ–≤ `=== NSJ CALCULATION START ===`
- ‚ùå –õ–æ–≥–æ–≤ `NSJ API CALL START`
- ‚ùå –ó–∞–ø—Ä–æ—Å–æ–≤ –∫ `https://demo.avinfors.ru/api-life/api/flow/`

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
- ‚úÖ –†–∞—Å—á–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: `recommended_replenishment: 124847.71`

### –î–ª—è —Ü–µ–ª–∏ "–ó–∞—â–∏—Ç–∞ –ñ–∏–∑–Ω–∏" (goal_type_id: 5)

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ API –ø–∞—Ä—Ç–Ω–µ—Ä–∞.

–í –ª–æ–≥–∞—Ö –î–û–õ–ñ–ù–´ –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏:

#### 1. –ù–∞—á–∞–ª–æ —Ä–∞—Å—á–µ—Ç–∞ NSJ:
```
=== NSJ CALCULATION START ===
Goal: –ó–∞—â–∏—Ç–∞ –ñ–∏–∑–Ω–∏ Goal ID: 5
Target amount: 3000000 Term months: 180
Client data: {
  "birth_date": "1990-01-01",
  "sex": "male",
  ...
}
```

#### 2. –í—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–∞:
```
Calling nsjApiService.calculateLifeInsurance with params: {
  "target_amount": 3000000,
  "term_months": 180,
  "client": {...},
  "payment_variant": 0,
  "program": "test"
}
```

#### 3. –î–µ—Ç–∞–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–∞—Ä—Ç–Ω–µ—Ä–∞:
```
=== calculateLifeInsurance called ===
Params: {...}
API URL from env: NOT SET (using default)
API Key from env: NOT SET (using default)
NSJ API Request: {
  "beginDate": "12.12.2025 00:00:00",
  "insConditions": {
    "program": "test",
    "currency": "RUR",
    "paymentVariant": 0,
    "term": 15
  },
  ...
}
```

#### 4. HTTP –∑–∞–ø—Ä–æ—Å –∫ –ø–∞—Ä—Ç–Ω–µ—Ä—É:
```
=== NSJ API CALL START ===
API URL: https://demo.avinfors.ru/api-life/api/flow/
API Key: ede88df2c0...
Operation: Contract.LifeEndowment.calculate
Request URL: https://demo.avinfors.ru/api-life/api/flow/
Request hostname: demo.avinfors.ru
Request path: /api-life/api/flow/
Request method: POST
Request body: {"operation":"Contract.LifeEndowment.calculate",...}
Sending HTTP request...
```

#### 5. –û—Ç–≤–µ—Ç –æ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä–∞:
```
Response received. Status: 200 OK
Response headers: {...}
Response body received, length: 2188
NSJ API Response: {
  "success": true,
  "data": {
    "term": 15,
    "risks": [...],
    "premium": 245000.76,
    ...
  }
}
```

#### 6. –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
NSJ Result received: {
  "success": true,
  "term": 15,
  "total_premium": 245000.76,
  "risks": [...],
  ...
}
```

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ, –µ—Å–ª–∏:

1. **–î–ª—è "–î–æ–º"**:
   - –ù–µ—Ç –ª–æ–≥–æ–≤ NSJ API
   - –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—è

2. **–î–ª—è "–ó–∞—â–∏—Ç–∞ –ñ–∏–∑–Ω–∏"**:
   - –ï—Å—Ç—å –≤—Å–µ –ª–æ–≥–∏ –≤—ã—à–µ (–æ—Ç `=== NSJ CALCULATION START ===` –¥–æ `NSJ Result received`)
   - HTTP –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ `demo.avinfors.ru`
   - –ü–æ–ª—É—á–µ–Ω —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200 OK)
   - –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ä–∏—Å–∫–∞—Ö –∏ –ø—Ä–µ–º–∏–∏

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –µ—Å–ª–∏:

1. –î–ª—è "–î–æ–º" –µ—Å—Ç—å –ª–æ–≥–∏ NSJ API (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å!)
2. –î–ª—è "–ó–∞—â–∏—Ç–∞ –ñ–∏–∑–Ω–∏" –Ω–µ—Ç –ª–æ–≥–æ–≤ NSJ API (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å!)
3. –û—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ API –ø–∞—Ä—Ç–Ω–µ—Ä–∞
4. –ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç API –ø–∞—Ä—Ç–Ω–µ—Ä–∞

## üìä –ü–æ—Å–ª–µ–¥–Ω–∏–π —É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å

**Request ID**: `flYdRym4QJWu3bZA0-QtfA`  
**–í—Ä–µ–º—è**: 12 Dec 2025 13:13:16 GMT  
**–°—Ç–∞—Ç—É—Å**: 200 OK  
**–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞**: 2816ms

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**:
- ‚úÖ –¶–µ–ª—å 1 (–î–æ–º): –†–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –¶–µ–ª—å 2 (–ó–∞—â–∏—Ç–∞ –ñ–∏–∑–Ω–∏): –†–∞—Å—Å—á–∏—Ç–∞–Ω–∞ —á–µ—Ä–µ–∑ API –ø–∞—Ä—Ç–Ω–µ—Ä–∞

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —á–µ—Ä–µ–∑ CLI
railway logs

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ NSJ
railway logs | grep -i "NSJ"

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ Request ID
railway logs | grep "flYdRym4QJWu3bZA0-QtfA"
```














